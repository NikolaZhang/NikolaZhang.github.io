import{_ as e}from"./_plugin-vue_export-helper.cdc0426e.js";import{o,c as a,e as c}from"./app.4001f435.js";const t={},n=c('<blockquote><p>\u8C08\u4E00\u8C08jenkins\u90E8\u7F72\u7684\u4E00\u4E9B\u65B9\u6CD5, \u987A\u4FBF\u628A\u8FD9\u51E0\u5929\u8E29\u7684\u7684\u5751\u7B80\u5355\u7684\u6574\u7406\u4E00\u4E0B.</p></blockquote><h2 id="\u5982\u4F55\u901A\u8FC7\u63D0\u4EA4\u4FE1\u606F\u6784\u5EFA" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u901A\u8FC7\u63D0\u4EA4\u4FE1\u606F\u6784\u5EFA" aria-hidden="true">#</a> \u5982\u4F55\u901A\u8FC7\u63D0\u4EA4\u4FE1\u606F\u6784\u5EFA</h2><p>\u901A\u8FC7webhook, \u5F53\u63D0\u4EA4\u4EE3\u7801\u5230\u8FDC\u7A0B\u4ED3\u5E93\u540E, \u53EF\u4EE5\u76F4\u63A5\u89E6\u53D1jenkins\u6784\u5EFA\u6D41\u7A0B.</p><h3 id="gitee\u7684webhook" tabindex="-1"><a class="header-anchor" href="#gitee\u7684webhook" aria-hidden="true">#</a> gitee\u7684webhook</h3><p>\u5728\u4ED3\u5E93\u4E2D\u7684setting\u4E2D\u6211\u4EEC\u53EF\u4EE5\u627E\u5230webhook\u9009\u9879 <img src="https://tech.nikolazhang.top/2020-04-03-00-01-50.png" alt="2020-04-03-00-01-50" loading="lazy"></p><p>\u70B9\u51FBadd. url\u4E2D\u9700\u8981\u586B\u5165jenkins\u8DEF\u5F84 <code>http://&lt;username&gt;:&lt;password&gt;@&lt;JENKINS_URL&gt;/generic-webhook-trigger/invoke</code> \u5176\u4E2Dusername\u548Cpassword\u4E3A\u53EF\u4EE5\u767B\u5F55jenkins\u7684\u7528\u6237\u8D26\u53F7\u5BC6\u7801. JENKINS_URL\u4E3Ajenkins\u7684\u8BBF\u95EE\u8DEF\u5F84. \u5F53\u7136\u4F60\u53EF\u4EE5\u4F7F\u7528ip+\u7AEF\u53E3\u7684\u65B9\u5F0F \u4E0A\u9762\u7684\u8FD9\u4E2A\u8DEF\u5F84\u53EF\u4EE5\u5728jenkins\u9879\u76EE\u914D\u7F6E\u4E2D\u627E\u5230: <img src="https://tech.nikolazhang.top/2020-04-03-00-05-22.png" alt="2020-04-03-00-05-22" loading="lazy"> \u5F53\u4F60\u9009\u62E9\u901A\u8FC7webhook\u89E6\u53D1\u6784\u5EFA\u7684\u65F6\u5019\u5C31\u53EF\u4EE5\u627E\u5230\u8FD9\u4E2A\u8DEF\u5F84. \u4E4B\u540E\u6839\u636E\u9700\u8981\u9009\u62E9\u89E6\u53D1\u7684\u4E8B\u4EF6\u7C7B\u578B: <img src="https://tech.nikolazhang.top/2020-04-03-00-07-49.png" alt="2020-04-03-00-07-49" loading="lazy"></p><p>\u4E4B\u540E\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7<code>Test</code>\u6D4B\u8BD5\u662F\u5426\u8FDE\u63A5\u6210\u529F. \u6210\u529F\u4E4B\u540E\u5C31\u53EF\u4EE5\u8FDB\u884Cjenkins\u7AEF\u9879\u76EE\u6784\u5EFA\u6761\u4EF6\u7684\u914D\u7F6E. \u4EE5syscore\u6A21\u5757\u7684\u7F16\u8BD1\u4E3A\u4F8B: \u5982\u4E0B\u56FE\u6240\u793A\u6211\u8BBE\u7F6E\u4E86\u4E24\u4E2A\u53D8\u91CF\u4E00\u4E2A\u662F<code>repository</code>\u4E00\u4E2A\u662F<code>commits</code>, \u8FD9\u4E24\u4E2A\u53D8\u91CF\u7684\u503C\u662F\u901A\u8FC7<code>JSONPath</code>\u8868\u8FBE\u5F0F\u4ECEwebhook\u8BF7\u6C42\u4F53\u4E2D\u83B7\u53D6\u6784\u5EFA\u7684\u4ED3\u5E93\u4EE5\u53CA\u63D0\u4EA4\u4FE1\u606F\u4E2D\u542B\u6709<code>build syscore</code>\u7684\u6570\u91CF. \u4E4B\u540E\u901A\u8FC7<code>Optional filter</code>\u5C06\u8FD9\u4E24\u4E2A\u53D8\u91CF<code>$repository_$commits</code>, \u8FDB\u884C\u6B63\u5219\u5339\u914D<code>^communicate_\\[[1-9][0-9]*\\]$</code>\u5982\u679C\u4E3A<code>communicate</code>\u4ED3\u5E93\u4E14<code>build syscore</code>\u7684\u6570\u91CF\u5927\u4E8E0\u5219\u89E6\u53D1\u6784\u5EFA. <img src="https://tech.nikolazhang.top/2020-04-03-00-10-29.png" alt="2020-04-03-00-10-29" loading="lazy"><img src="https://tech.nikolazhang.top/2020-04-03-00-10-49.png" alt="2020-04-03-00-10-49" loading="lazy"></p><p>\u6240\u4EE5\u9488\u5BF9\u4E0D\u540C\u7C7B\u578B\u7684\u63D0\u4EA4\u8BF7\u6C42\u4F53\u53EF\u80FD\u662F\u4E0D\u540C\u7684, \u56E0\u6B64\u9700\u8981\u6839\u636E\u5B9E\u9645\u60C5\u51B5\u8FDB\u884C\u914D\u7F6E. \u4E4B\u524D\u6211\u4EEC\u5728gitee\u4ED3\u5E93\u4E2D\u5BF9jenkins\u8FDE\u63A5\u8FDB\u884C\u4E86\u6D4B\u8BD5, \u6211\u4EEC\u53EF\u4EE5\u5728\u6D4B\u8BD5\u7684\u8BF7\u6C42\u4FE1\u606F\u4E2D\u770B\u5230webhook\u8BF7\u6C42\u4F53\u7684\u8BE6\u7EC6\u60C5\u51B5. <img src="https://tech.nikolazhang.top/2020-04-03-00-19-04.png" alt="2020-04-03-00-19-04" loading="lazy"></p><h2 id="\u6784\u5EFA\u4E4B\u540E" tabindex="-1"><a class="header-anchor" href="#\u6784\u5EFA\u4E4B\u540E" aria-hidden="true">#</a> \u6784\u5EFA\u4E4B\u540E</h2><p>\u9879\u76EE\u6784\u5EFA\u4E4B\u540E\u6211\u4EEC\u5C31\u9700\u8981\u5C06\u5176\u53D1\u5E03.</p><p>\u6CE8\u610F\u6784\u5EFA\u6210\u529F\u4E4B\u540E\u9879\u76EE\u7684\u6587\u4EF6\u662F\u653E\u5728jenkins\u7684workspace\u76EE\u5F55\u4E0B\u7684. \u8FD9\u4E2A\u76EE\u5F55\u9ED8\u8BA4\u4F4D\u7F6E\u4E3A<code>/var/lib/jenkins/workspace</code>, \u4F60\u53EF\u4EE5\u5728\u8FD9\u4E2A\u76EE\u5F55\u4E0B\u627E\u5230\u6784\u5EFA\u6210\u529F\u7684\u6587\u4EF6.</p><p>\u5982\u679C\u9879\u76EE\u90E8\u7F72\u7684\u4F4D\u7F6E\u548Cjenkins\u5728\u540C\u4E00\u53F0\u670D\u52A1\u5668\u4E0A, \u76F4\u63A5\u901A\u8FC7\u62F7\u8D1D\u5230\u5BF9\u5E94\u7684\u76EE\u5F55\u4E0B\u5C31\u53EF\u4EE5\u4E86. \u5426\u5219\u5C31\u9700\u8981\u4F7F\u7528ssh\u8FDB\u884C\u6587\u4EF6\u4F20\u8F93. \u4F60\u53EF\u4EE5\u4F7F\u7528<code>scp</code>\u6216\u8005\u501F\u52A9<code>Publish Over SSH</code>\u63D2\u4EF6.</p><p>\u4E0B\u9762\u4ECB\u7ECD\u4E00\u4E0B\u8FD9\u4E2A\u63D2\u4EF6\u5982\u4F55\u4F7F\u7528.</p><p>\u5B89\u88C5\u63D2\u4EF6\u4E4B\u540E\u4F60\u5E94\u8BE5\u80FD\u770B\u5230\u4E0B\u56FE\u4E2D\u7684\u7EA2\u6846\u5185\u5BB9: <img src="https://tech.nikolazhang.top/2020-04-03-00-26-45.png" alt="2020-04-03-00-26-45" loading="lazy"></p><p><img src="https://tech.nikolazhang.top/2020-04-03-00-28-46.png" alt="2020-04-03-00-28-46" loading="lazy"> \u9996\u8981\u4F60\u8981\u9009\u4E2D\u4E00\u4E2A\u4F60\u63D0\u524D\u914D\u7F6E\u597D\u7684ssh server. \u8FD9\u4E2A\u914D\u7F6E\u662F\u5728<code>Manage Jenkins</code>\u7684<code>Config SYSTEM</code>\u4E2D. \u4E4B\u540E\u6211\u4EEC\u8981\u914D\u7F6E\u4F20\u8F93\u7684\u6587\u4EF6\u7684\u8DEF\u5F84, \u6CE8\u610F\u8FD9\u4E2A\u8DEF\u5F84\u662F\u76F8\u5BF9\u4E8E\u5F53\u524D\u6784\u5EFA\u6A21\u5757\u6765\u8BF4\u7684. \u6211\u4F7F\u7528\u7684syscore\u6A21\u5757\u7684\u8DEF\u5F84\u4E3A<code>/var/lib/jenkins/workspace/commuicate/syscore/</code>, \u6CE8\u610F\u8FD9\u4E2A\u8DEF\u5F84\u672B\u5C3E\u7684syscore\u5C31\u662F\u6307\u7684\u662F\u8FD9\u4E2A\u6784\u5EFA\u6A21\u5757\u7684\u540D\u5B57. \u56E0\u6B64\u914D\u7F6E\u8DEF\u5F84\u76F4\u63A5\u4ECE\u8FD9\u4E2A\u8DEF\u5F84\u4E0B\u5F00\u59CB\u914D\u7F6E\u5373\u53EF. <code>Remove prefix</code>\u7528\u6765\u5728\u8FDC\u7A0B\u521B\u5EFA\u6587\u4EF6\u65F6\u79FB\u9664\u8DEF\u5F84\u524D\u7F00. <code>Remote directory</code> \u8FD9\u4E2A\u8DEF\u5F84\u7684\u914D\u7F6E\u662F\u76F8\u5BF9\u4E8Essh server\u4E2D\u7684\u5168\u5C40\u8DEF\u5F84\u6765\u8BF4\u7684. \u4F60\u53EF\u4EE5\u770B\u4E0B\u4E00\u8282ssh server\u7684\u4ECB\u7ECD. <code>Exec command</code> \u8FD9\u4E2A\u5C31\u662F\u4F60\u60F3\u8981\u5728\u8FDC\u7A0B\u670D\u52A1\u5668\u8FD0\u884C\u7684\u547D\u4EE4. \u4E00\u822C\u6211\u4EEC\u7528\u5B83\u6765\u8FD0\u884C\u542F\u52A8\u811A\u672C. \u4E0D\u8FC7\u4F60\u8981\u63D0\u524D\u5728\u8FDC\u7A0B\u670D\u52A1\u5668\u6DFB\u52A0\u542F\u52A8\u811A\u672C. \u5F53\u7136\u4F60\u53EF\u4EE5\u5C1D\u8BD5\u5728\u6B64\u5904\u7F16\u5199\u542F\u52A8\u811A\u672C.</p><h3 id="\u914D\u7F6Essh-server" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6Essh-server" aria-hidden="true">#</a> \u914D\u7F6Essh server</h3><p>\u627E\u5230<code>Publish over SSH</code>\u6A21\u5757, \u4EFF\u7167\u4E0B\u56FE\u8FDB\u884C\u914D\u7F6E: <img src="https://tech.nikolazhang.top/2020-04-03-00-32-27.png" alt="2020-04-03-00-32-27" loading="lazy"></p><p><code>Passphrase</code>\u53CAssh\u7684\u5BC6\u7801, <code>Path to key</code>\u662F\u4F60\u7684\u79C1\u94A5\u7684\u8DEF\u5F84. <code>Key</code>\u4E2D\u7684\u5185\u5BB9\u76F4\u63A5\u590D\u5236\u79C1\u94A5\u4E2D\u7684\u4FE1\u606F\u7C98\u8D34\u5373\u53EF.</p><p><code>SSH Servers</code>\u7684\u914D\u7F6E\u4E2Dhostname\u662F\u8FDC\u7A0B\u670D\u52A1\u5668\u7684\u5730\u5740, <code>username</code>\u662F\u8BBF\u95EE\u8FDC\u7A0B\u670D\u52A1\u5668\u7684\u8D26\u53F7, <code>Remote Directory</code>\u662F\u4E00\u4E2A\u9ED8\u8BA4\u7684\u5168\u5C40\u8DEF\u5F84.</p><h2 id="\u524D\u7AEF\u6784\u5EFA\u548C\u540E\u7AEF\u6784\u5EFA" tabindex="-1"><a class="header-anchor" href="#\u524D\u7AEF\u6784\u5EFA\u548C\u540E\u7AEF\u6784\u5EFA" aria-hidden="true">#</a> \u524D\u7AEF\u6784\u5EFA\u548C\u540E\u7AEF\u6784\u5EFA</h2><p>\u524D\u7AEF\u6784\u5EFA\u548C\u540E\u7AEF\u6784\u5EFA\u662F\u4E0D\u540C\u7684.</p><p>\u540E\u7AEF\u7684\u6784\u5EFA\u6211\u4EEC\u521B\u5EFAitem\u7684\u65F6\u5019\u4F7F\u7528\u7684\u662F<code>maven project</code>\u56E0\u6B64\u501F\u52A9maven\u63D2\u4EF6\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7\u914D\u7F6E\u5982\u4E0B\u4FE1\u606F\u6784\u5EFAmaven\u9879\u76EE. <img src="https://tech.nikolazhang.top/2020-04-03-00-47-57.png" alt="2020-04-03-00-47-57" loading="lazy"> \u524D\u7AEF\u7684\u6784\u5EFA\u4E5F\u5F88\u7B80\u5355, \u53EF\u4EE5\u76F4\u63A5\u6DFB\u52A0\u4E00\u4E2A\u6784\u5EFA\u811A\u672C\u5373\u53EF. <img src="https://tech.nikolazhang.top/2020-04-03-00-49-15.png" alt="2020-04-03-00-49-15" loading="lazy"></p><h2 id="\u6784\u5EFA\u5DE5\u4F5C\u6D41" tabindex="-1"><a class="header-anchor" href="#\u6784\u5EFA\u5DE5\u4F5C\u6D41" aria-hidden="true">#</a> \u6784\u5EFA\u5DE5\u4F5C\u6D41</h2><p>\u5728\u4E00\u4E9B\u60C5\u51B5\u4E0B\u6211\u4EEC\u7684\u6784\u5EFA\u662F\u6709\u5148\u540E\u987A\u5E8F\u7684, \u6BD4\u5982\u6211\u4EEC\u4FEE\u6539\u4E86\u4E00\u4E2A\u516C\u5171\u6A21\u5757, \u56E0\u6B64\u8981\u4F18\u5148\u6784\u5EFA\u8BE5\u6A21\u5757, \u4E4B\u540E\u518D\u6784\u5EFA\u5176\u4ED6\u6A21\u5757. \u8FD9\u4E2A\u53EF\u4EE5\u901A\u8FC7\u8BBE\u7F6E\u6784\u5EFA\u89E6\u53D1\u5668\u8FDB\u884C\u63A7\u5236(webhook\u4E5F\u662F\u6784\u5EFA\u89E6\u53D1\u5668\u7684\u4E00\u79CD)</p><p><img src="https://tech.nikolazhang.top/2020-04-03-00-53-52.png" alt="2020-04-03-00-53-52" loading="lazy"></p><p><code>Build after other projects are built</code> \u4E2D\u7684<code>Projects to watch</code>\u4E2D\u914D\u7F6E\u7684\u5C31\u662F\u4F18\u5148\u6784\u5EFA\u7684\u6A21\u5757, \u5F53\u8FD9\u4E2A<code>common</code>\u6A21\u5757\u6784\u5EFA\u6210\u529F\u4E4B\u540E\u4F1A\u89E6\u53D1\u5F53\u524D\u6A21\u5757\u7684\u6784\u5EFA.</p><p>\u914D\u7F6E\u4E4B\u540E, \u4F60\u53EF\u4EE5\u5728<code>common</code>\u6A21\u5757\u7684\u9875\u9762\u4E2D\u770B\u5230<code>Downstream Projects</code>\u4FE1\u606F <img src="https://tech.nikolazhang.top/2020-04-03-00-55-39.png" alt="2020-04-03-00-55-39" loading="lazy"></p><h2 id="end" tabindex="-1"><a class="header-anchor" href="#end" aria-hidden="true">#</a> end</h2>',28),d=[n];function s(i,r){return o(),a("div",null,d)}const l=e(t,[["render",s],["__file","jenkins\u90E8\u7F72\u76F8\u5173.html.vue"]]);export{l as default};
