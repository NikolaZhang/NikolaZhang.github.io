import{_ as p}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as e,c as o,a as n,b as a,d as c,e as s,r as l}from"./app.4001f435.js";const u={},i=s(`<h2 id="\u4ECEsqlsessionfactory\u521B\u5EFA\u8BF4\u8D77" tabindex="-1"><a class="header-anchor" href="#\u4ECEsqlsessionfactory\u521B\u5EFA\u8BF4\u8D77" aria-hidden="true">#</a> \u4ECESqlSessionFactory\u521B\u5EFA\u8BF4\u8D77</h2><blockquote><p>\u4F7F\u7528<code>SqlSessionFactoryBuilder</code>\u89E3\u6790\u4F20\u5165\u7684mybatis.xml\u914D\u7F6E, \u53EF\u4EE5\u521B\u5EFA\u51FA<code>SqlSessionFactory</code>.</p></blockquote><p>\u5982\u4E0B\u4E3A\u521B\u5EFA<code>SqlSessionFactory</code>\u7684\u65B9\u6CD5.</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">SqlSessionFactoryBuilder</span> sqlSessionFactoryBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;config/mybatis-config.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> sqlSessionFactoryBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>xml\u6587\u4EF6\u7684\u89E3\u6790\u662F\u901A\u8FC7<code>XMLConfigBuilder</code>\u7684<code>parse</code>\u65B9\u6CD5\u8FDB\u884C\u7684. \u8BE5\u65B9\u6CD5\u89E3\u6790\u4E4B\u540E\u4F1A\u8FD4\u56DE\u4E00\u4E2A<code>Configuration</code>\u5BF9\u8C61.</li><li>\u6700\u540E\u8C03\u7528<code>build</code>\u65B9\u6CD5, \u5C06<code>Configuration</code>\u5BF9\u8C61\u4F5C\u4E3A\u53C2\u6570, \u5B9E\u4F8B\u5316<code>DefaultSqlSessionFactory</code>, \u5F97\u5230<code>SqlSessionFactory</code>.</li></ol><h2 id="xmlconfigbuilder" tabindex="-1"><a class="header-anchor" href="#xmlconfigbuilder" aria-hidden="true">#</a> XMLConfigBuilder</h2><h3 id="\u521D\u59CB\u5316" tabindex="-1"><a class="header-anchor" href="#\u521D\u59CB\u5316" aria-hidden="true">#</a> \u521D\u59CB\u5316</h3><blockquote><p><code>XMLConfigBuilder</code>\u5BF9\u8C61\u9700\u8981\u6301\u6709Xml\u89E3\u6790\u5668<code>XPathParser</code>, \u6FC0\u6D3B\u7684\u5F53\u524D\u73AF\u5883\u4FE1\u606F, \u5C5E\u6027\u53C2\u6570. \u5176\u6784\u9020\u5668\u89C1\u4E0B:</p></blockquote><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">XMLConfigBuilder</span><span class="token punctuation">(</span><span class="token class-name">XPathParser</span> parser<span class="token punctuation">,</span> <span class="token class-name">String</span> environment<span class="token punctuation">,</span> <span class="token class-name">Properties</span> props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ErrorContext</span><span class="token punctuation">.</span><span class="token function">instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">resource</span><span class="token punctuation">(</span><span class="token string">&quot;SQL Mapper Configuration&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>configuration<span class="token punctuation">.</span><span class="token function">setVariables</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>parsed <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>environment <span class="token operator">=</span> environment<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>parser <span class="token operator">=</span> parser<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>\u8FD9\u91CC\u9996\u5148\u521D\u59CB\u5316\u4E86\u4E00\u4E2A<code>Configuration</code>. \u5E76\u5C06<code>parsed</code>\u8BBE\u7F6E\u72B6\u6001(\u672A\u89E3\u6790).</p></blockquote><h3 id="\u8C03\u7528parse\u65B9\u6CD5\u89E3\u6790xml" tabindex="-1"><a class="header-anchor" href="#\u8C03\u7528parse\u65B9\u6CD5\u89E3\u6790xml" aria-hidden="true">#</a> \u8C03\u7528parse\u65B9\u6CD5\u89E3\u6790xml</h3><ol><li><code>parse</code> \u65B9\u6CD5\u8C03\u7528\u540E\u9996\u5148\u6839\u636E<code>parsed</code>\u5224\u65AD\u662F\u5426\u5DF2\u7ECF\u8FDB\u884C\u8FC7\u89E3\u6790. \u6CA1\u6709\u5219\u5C06\u5176\u8BBE\u7F6E\u4E3Atrue.</li><li>\u4E4B\u540E\u8C03\u7528<code>parseConfiguration</code>\u65B9\u6CD5, \u8BE5\u65B9\u6CD5\u4F1A\u89E3\u6790xml\u4E2D\u7684\u5404\u8282\u70B9\u914D\u7F6E, \u5E76\u7ED9<code>configuration</code>\u8D4B\u503C.</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Configuration</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>parsed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BuilderException</span><span class="token punctuation">(</span><span class="token string">&quot;Each XMLConfigBuilder can only be used once.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
parsed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token function">parseConfiguration</span><span class="token punctuation">(</span>parser<span class="token punctuation">.</span><span class="token function">evalNode</span><span class="token punctuation">(</span><span class="token string">&quot;/configuration&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> configuration<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>evalNode</code> \u65B9\u6CD5\u901A\u8FC7Xpath\u8868\u8FBE\u5F0F\u83B7\u53D6xml\u4E2D\u7684\u8282\u70B9\u4FE1\u606F(\u7ED3\u679C\u5C01\u88C5\u4E3A: XNode, \u5B83\u662Fxml\u8282\u70B9\u7684\u7C7B\u578B,\u5C5E\u6027,\u540D\u79F0xpath\u8868\u8FBE\u5F0F\u7B49\u7684\u8868\u793A).<br><code>parser.evalNode(&quot;/configuration&quot;)</code> \u5C31\u83B7\u53D6\u5230\u4E86xml\u914D\u7F6E\u4E2D\u7684<code>configuration</code>\u8282\u70B9. \u5E76\u5C06\u5176\u4F5C\u4E3A\u83B7\u53D6\u540E\u7EED\u8282\u70B9\u8FDB\u884C\u89E3\u6790\u7684\u6839\u8282\u70B9.</p></blockquote><hr><h2 id="\u914D\u7F6E\u6587\u4EF6\u89E3\u6790" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u6587\u4EF6\u89E3\u6790" aria-hidden="true">#</a> \u914D\u7F6E\u6587\u4EF6\u89E3\u6790</h2><h3 id="properties\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#properties\u8282\u70B9" aria-hidden="true">#</a> properties\u8282\u70B9</h3><p>\u8BE5\u8282\u70B9\u7684\u914D\u7F6E\u65B9\u5F0F\u5982\u4E0B, <code>resource</code>\u6307\u5B9A\u4E86\u53C2\u6570\u914D\u7F6E\u6587\u4EF6\u7684\u4F4D\u7F6E</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org/mybatis/example/config.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dev_user<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>F2Fa3!33TYyg<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5BF9\u8BE5\u8282\u70B9\u7684\u89E3\u6790\u4F7F\u7528<code>propertiesElement</code>\u65B9\u6CD5, \u65B9\u6CD5\u7684\u8F93\u5165\u53C2\u6570\u4E3A<code>root.evalNode(&quot;properties&quot;)</code>, \u5373<code>properties</code>\u8282\u70B9\u7684\u5C01\u88C5.</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">propertiesElement</span><span class="token punctuation">(</span><span class="token class-name">XNode</span> context<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>context <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Properties</span> defaults <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getChildrenAsProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> resource <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getStringAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;resource&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> url <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getStringAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>resource <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> url <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BuilderException</span><span class="token punctuation">(</span><span class="token string">&quot;The properties element cannot specify both a URL and a resource based property file reference.  Please specify one or the other.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>resource <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            defaults<span class="token punctuation">.</span><span class="token function">putAll</span><span class="token punctuation">(</span><span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsProperties</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            defaults<span class="token punctuation">.</span><span class="token function">putAll</span><span class="token punctuation">(</span><span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getUrlAsProperties</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Properties</span> vars <span class="token operator">=</span> configuration<span class="token punctuation">.</span><span class="token function">getVariables</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>vars <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            defaults<span class="token punctuation">.</span><span class="token function">putAll</span><span class="token punctuation">(</span>vars<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        parser<span class="token punctuation">.</span><span class="token function">setVariables</span><span class="token punctuation">(</span>defaults<span class="token punctuation">)</span><span class="token punctuation">;</span>
        configuration<span class="token punctuation">.</span><span class="token function">setVariables</span><span class="token punctuation">(</span>defaults<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8BE5\u65B9\u6CD5\u4E3B\u8981\u7528\u4E8E\u83B7\u53D6mybatis\u7684\u6240\u6709\u914D\u7F6E\u4FE1\u606F, \u4E3B\u8981\u6765\u81EA\u4E8E4\u4E2A\u65B9\u9762:</p><ol><li>\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684<code>properties</code>\u4E0B<code>property</code>\u4E2D\u7684\u914D\u7F6E.</li><li><code>properties</code>\u4E2D\u7684<code>resource</code>\u5C5E\u6027\u6240\u6307\u4F4D\u7F6E\u7684\u914D\u7F6E\u6587\u4EF6</li><li><code>properties</code>\u4E2D\u7684<code>url</code>\u5C5E\u6027\u6240\u6307\u4F4D\u7F6E\u7684\u914D\u7F6E\u6587\u4EF6</li><li><code>configuration</code>\u5BF9\u8C61\u4E2D\u7684\u5C5E\u6027\u914D\u7F6E, \u4E00\u822C\u7A0B\u5E8F\u5728\u521B\u5EFA<code>XMLConfigBuilder</code>\u4F1A\u8FDB\u884C\u8BBE\u7F6E.</li></ol><p>\u4EE5\u4E0A\u7684\u5C5E\u6027\u90FD\u4F1A\u91CD\u65B0\u8BBE\u7F6E\u5230<code>configuration</code>\u5BF9\u8C61\u4E2D\u53BB, \u5E76\u4EA4\u7ED9\u89E3\u6790\u5668\u8FDB\u884C\u5904\u7406.</p><blockquote><p><code>getChildrenAsProperties</code>: \u83B7\u53D6\u5F53\u524D\u8282\u70B9\u4E0B\u7684\u5B50\u8282\u70B9, \u5C06\u8282\u70B9\u7684name\u548Cvalue\u5C5E\u6027\u503C, \u5B58\u653E\u5230<code>Properties</code>\u4E2D.</p></blockquote><h3 id="settings\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#settings\u8282\u70B9" aria-hidden="true">#</a> settings\u8282\u70B9</h3><p>\u8BE5\u8282\u70B9\u7684\u5C5E\u6027\u914D\u7F6E\u662F\u6211\u4EEC\u64CD\u4F5C\u7684\u91CD\u70B9. \u914D\u7F6E\u5982\u4E0B:</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cacheEnabled<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lazyLoadingEnabled<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>multipleResultSetsEnabled<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>useColumnLabel<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>useGeneratedKeys<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>autoMappingBehavior<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>PARTIAL<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>autoMappingUnknownColumnBehavior<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>WARNING<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>defaultExecutorType<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>SIMPLE<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>defaultStatementTimeout<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>25<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>defaultFetchSize<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>safeRowBoundsEnabled<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mapUnderscoreToCamelCase<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>localCacheScope<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>SESSION<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbcTypeForNull<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>OTHER<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lazyLoadTriggerMethods<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>equals,clone,hashCode,toString<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5BF9\u5E94\u7684\u89E3\u6790\u65B9\u6CD5\u4E3A<code>settingsAsProperties</code>, \u8BE5\u65B9\u6CD5\u540C\u6837\u4F7F\u7528<code>getChildrenAsProperties</code>\u83B7\u53D6\u5B50\u8282\u70B9\u4E2D\u7684\u952E\u503C, \u5E76\u8FD4\u56DE<code>Properties</code>\u5BF9\u8C61.</p><p>\u4E4B\u540E\u5BF9\u8BBE\u7F6E\u7684\u53C2\u6570\u8FDB\u884C\u5904\u7406, \u76F8\u5173\u65B9\u6CD5\u89C1\u4E0B:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token function">loadCustomVfs</span><span class="token punctuation">(</span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadCustomLogImpl</span><span class="token punctuation">(</span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token function">settingsElement</span><span class="token punctuation">(</span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>loadCustomVfs</code>: \u6307\u5B9AVFS(\u865A\u62DF\u6587\u4EF6\u7CFB\u7EDF)\u7684\u5B9E\u73B0.<br> \u8BE5\u65B9\u6CD5\u5C06\u5B57\u7B26\u4E32\u914D\u7F6E\u53CD\u5C04\u4E3AClass, \u914D\u7F6E\u5230<code>Configuration</code>\u7684<code>Class&lt;? extends VFS&gt; vfsImpl</code>\u5C5E\u6027\u4E0A\u53BB.</p></li><li><p><code>loadCustomLogImpl</code>: \u6307\u5B9A MyBatis \u6240\u7528\u65E5\u5FD7\u7684\u5177\u4F53\u5B9E\u73B0\uFF0C\u672A\u6307\u5B9A\u65F6\u5C06\u81EA\u52A8\u67E5\u627E.<br> \u53EF\u4F7F\u7528\u7684\u65E5\u5FD7\u6846\u67B6\u53CA\u5B9E\u73B0\u5982\u4E0B:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>  typeAliasRegistry<span class="token punctuation">.</span><span class="token function">registerAlias</span><span class="token punctuation">(</span><span class="token string">&quot;SLF4J&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Slf4jImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  typeAliasRegistry<span class="token punctuation">.</span><span class="token function">registerAlias</span><span class="token punctuation">(</span><span class="token string">&quot;COMMONS_LOGGING&quot;</span><span class="token punctuation">,</span> <span class="token class-name">JakartaCommonsLoggingImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  typeAliasRegistry<span class="token punctuation">.</span><span class="token function">registerAlias</span><span class="token punctuation">(</span><span class="token string">&quot;LOG4J&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Log4jImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  typeAliasRegistry<span class="token punctuation">.</span><span class="token function">registerAlias</span><span class="token punctuation">(</span><span class="token string">&quot;LOG4J2&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Log4j2Impl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  typeAliasRegistry<span class="token punctuation">.</span><span class="token function">registerAlias</span><span class="token punctuation">(</span><span class="token string">&quot;JDK_LOGGING&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Jdk14LoggingImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  typeAliasRegistry<span class="token punctuation">.</span><span class="token function">registerAlias</span><span class="token punctuation">(</span><span class="token string">&quot;STDOUT_LOGGING&quot;</span><span class="token punctuation">,</span> <span class="token class-name">StdOutImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  typeAliasRegistry<span class="token punctuation">.</span><span class="token function">registerAlias</span><span class="token punctuation">(</span><span class="token string">&quot;NO_LOGGING&quot;</span><span class="token punctuation">,</span> <span class="token class-name">NoLoggingImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EE5\u4E0A\u914D\u7F6E\u53D1\u751F\u5728<code>Configuration</code>\u6784\u9020\u5668\u4E2D. \u83B7\u53D6\u5230\u5BF9\u5E94\u7684\u5B9E\u73B0\u7C7B\u540E, \u914D\u7F6E\u5230<code>Configuration</code>\u7684<code>Class&lt;? extends Log&gt; logImpl</code>\u5C5E\u6027\u4E0A\u53BB.</p></li><li><p><code>settingsElement</code>: \u8BBE\u7F6Exml\u4E2D\u7684\u914D\u7F6E\u5BF9\u5E94<code>Configuration</code>\u4E2D\u7684\u5C5E\u6027.</p></li></ul><h3 id="typealiases\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#typealiases\u8282\u70B9" aria-hidden="true">#</a> typeAliases\u8282\u70B9</h3><p><code>typeAliasesElement</code>\u65B9\u6CD5\u4E3A\u5904\u7406<code>typeAliases</code>\u8282\u70B9\u7684\u65B9\u6CD5. \u8BE5\u65B9\u6CD5\u5BF9\u4E24\u79CD\u5B50\u8282\u70B9\u8FDB\u884C\u5904\u7406:</p><ul><li><code>package</code></li><li><code>typeAlias</code></li></ul><p>\u83B7\u53D6\u5230\u8282\u70B9\u7684\u5C5E\u6027\u914D\u7F6E\u540E, \u901A\u8FC7<code>typeAliasRegistry.registerAlias</code>\u5C06\u5176\u6DFB\u52A0\u5230<code>private final Map&lt;String, Class&lt;?&gt;&gt; typeAliases = new HashMap&lt;&gt;();</code>\u4E2D\u7F13\u5B58.</p><h3 id="plugins\u63D2\u4EF6\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#plugins\u63D2\u4EF6\u8282\u70B9" aria-hidden="true">#</a> plugins\u63D2\u4EF6\u8282\u70B9</h3><p>\u4F7F\u7528\u8BE5\u8282\u70B9\u9996\u5148\u9700\u8981\u5B9E\u73B0<code>Interceptor</code>\u63A5\u53E3, \u5B9E\u73B0<code>intercept</code>\u65B9\u6CD5, \u6216\u8005\u91CD\u5199<code>setProperties</code>, \u7528\u4E8E\u7ED9\u5F53\u524D\u62E6\u622A\u5668\u8BBE\u7F6E\u5C5E\u6027.</p><p>\u8BE5\u8282\u70B9\u914D\u7F6E\u65B9\u5F0F\u5982:</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span> <span class="token attr-name">interceptor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.mybatis.example.ExamplePlugin<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>someProperty<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>pluginElement</code>\u65B9\u6CD5, \u89C1\u4E0B:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">pluginElement</span><span class="token punctuation">(</span><span class="token class-name">XNode</span> parent<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">XNode</span> child <span class="token operator">:</span> parent<span class="token punctuation">.</span><span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">String</span> interceptor <span class="token operator">=</span> child<span class="token punctuation">.</span><span class="token function">getStringAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;interceptor&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">Properties</span> properties <span class="token operator">=</span> child<span class="token punctuation">.</span><span class="token function">getChildrenAsProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">Interceptor</span> interceptorInstance <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Interceptor</span><span class="token punctuation">)</span> <span class="token function">resolveClass</span><span class="token punctuation">(</span>interceptor<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredConstructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      interceptorInstance<span class="token punctuation">.</span><span class="token function">setProperties</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
      configuration<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span>interceptorInstance<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u901A\u8FC7\u53CD\u5C04\u83B7\u53D6\u62E6\u622A\u5668\u5BF9\u8C61, \u5C06\u5176\u52A0\u5165\u5230\u62E6\u622A\u5668\u8C03\u7528\u94FE\u4E0A\u53BB. \u8BE5\u8C03\u7528\u94FE\u5728<code>InterceptorChain</code>\u7C7B\u4E2D\u5B9A\u4E49\u4E3A:<br><code>private final List&lt;Interceptor&gt; interceptors = new ArrayList&lt;&gt;();</code></p><h3 id="objectfactory\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#objectfactory\u8282\u70B9" aria-hidden="true">#</a> objectFactory\u8282\u70B9</h3><p>\u8BE5\u8282\u70B9\u4E3A\u5BF9\u8C61\u5DE5\u5382\u914D\u7F6E, mybatis\u4F1A\u4F7F\u7528\u5BF9\u8C61\u5DE5\u5382\u521B\u5EFA\u5B9E\u4F8B.<br> \u56E0\u6B64\u9700\u8981\u5C06\u5B9E\u73B0\u4E86<code>ObjectFactory</code>\u7684\u7C7B\u914D\u7F6E\u5230\u8BE5\u8282\u70B9\u7684<code>type</code>\u5C5E\u6027\u4E0A. mybatis\u63D0\u4F9B\u4E86\u8BE5\u63A5\u53E3\u7684\u9ED8\u8BA4\u5B9E\u73B0<code>DefaultObjectFactory</code>. \u53EF\u4EE5\u7EE7\u627F\u8BE5\u7C7B\u5E76\u505A\u4E00\u4E9B\u81EA\u5B9A\u4E49.</p><p>\u8BE5\u8282\u70B9\u7684\u89E3\u6790\u4F7F\u7528<code>objectFactoryElement</code>\u65B9\u6CD5, \u901A\u8FC7\u53CD\u5C04\u83B7\u53D6\u5B9E\u4F8B, \u5E76\u8BBE\u7F6E\u5230<code>Configuration</code>\u5BF9\u8C61\u4E0A.</p><h3 id="objectwrapperfactory\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#objectwrapperfactory\u8282\u70B9" aria-hidden="true">#</a> objectWrapperFactory\u8282\u70B9</h3><p><code>objectWrapperFactoryElement</code>\u7528\u4E8E\u89E3\u6790\u8BE5\u8282\u70B9.<br> \u8282\u70B9\u914D\u7F6E\u7C7B\u9700\u8981\u5B9E\u73B0<code>ObjectWrapperFactory</code>\u63A5\u53E3.</p><h3 id="reflectorfactory\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#reflectorfactory\u8282\u70B9" aria-hidden="true">#</a> reflectorFactory\u8282\u70B9</h3><p><code>reflectorFactoryElement</code>\u7528\u4E8E\u89E3\u6790\u8BE5\u8282\u70B9.<br> \u8282\u70B9\u914D\u7F6E\u7C7B\u9700\u8981\u5B9E\u73B0<code>ReflectorFactory</code>\u63A5\u53E3.</p><h3 id="environments\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#environments\u8282\u70B9" aria-hidden="true">#</a> environments\u8282\u70B9</h3><p>\u8BE5\u8282\u70B9\u7528\u4E8E\u5B9A\u4E49\u73AF\u5883\u914D\u7F6E:</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environments</span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>development<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environment</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>development<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transactionManager</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>JDBC<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transactionManager</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataSource</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>POOLED<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>driver<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>\${driver}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>\${url}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>\${username}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>\${password}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataSource</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environment</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environments</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>environmentsElement</code>\u7528\u4E8E\u89E3\u6790\u8BE5\u8282\u70B9\u7684\u914D\u7F6E. \u4EE5\u4E0B\u4E3A\u89E3\u6790\u4EE3\u7801:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">environmentsElement</span><span class="token punctuation">(</span><span class="token class-name">XNode</span> context<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>context <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>environment <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        environment <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getStringAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">XNode</span> child <span class="token operator">:</span> context<span class="token punctuation">.</span><span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> id <span class="token operator">=</span> child<span class="token punctuation">.</span><span class="token function">getStringAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isSpecifiedEnvironment</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token class-name">TransactionFactory</span> txFactory <span class="token operator">=</span> <span class="token function">transactionManagerElement</span><span class="token punctuation">(</span>child<span class="token punctuation">.</span><span class="token function">evalNode</span><span class="token punctuation">(</span><span class="token string">&quot;transactionManager&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token class-name">DataSourceFactory</span> dsFactory <span class="token operator">=</span> <span class="token function">dataSourceElement</span><span class="token punctuation">(</span>child<span class="token punctuation">.</span><span class="token function">evalNode</span><span class="token punctuation">(</span><span class="token string">&quot;dataSource&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token class-name">DataSource</span> dataSource <span class="token operator">=</span> dsFactory<span class="token punctuation">.</span><span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token class-name">Environment<span class="token punctuation">.</span>Builder</span> environmentBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Environment<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">transactionFactory</span><span class="token punctuation">(</span>txFactory<span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">dataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
          configuration<span class="token punctuation">.</span><span class="token function">setEnvironment</span><span class="token punctuation">(</span>environmentBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>\u5982\u679C\u521B\u5EFA<code>XMLConfigBuilder</code>\u65F6\u6CA1\u6709\u6307\u5B9A\u73AF\u5883\u914D\u7F6E(id), \u5219\u4F7F\u7528xml\u4E2D\u7684\u9ED8\u8BA4\u914D\u7F6E. \u5373\u83B7\u53D6<code>default</code>\u5C5E\u6027\u503C.</li><li>\u904D\u5386\u5B50\u8282\u70B9, \u627E\u5230\u5F53\u524D\u73AF\u5883\u7684\u914D\u7F6E\u76F8\u540C\u7684id. \u5982\u679C\u5339\u914D\u5219\u8FDB\u884C3\u6B65\u9AA4\u7684\u89E3\u6790\u8FC7\u7A0B, \u5426\u5219\u7EE7\u7EED\u5BFB\u627E\u5339\u914D\u7684\u73AF\u5883\u914D\u7F6E\u8282\u70B9.</li><li>\u73AF\u5883\u914D\u7F6E\u4E3B\u8981\u5305\u62EC: <ul><li>\u4E8B\u52A1\u5DE5\u5382: <code>TransactionFactory</code><br><code>transactionManagerElement</code>\u65B9\u6CD5\u6839\u636E<code>transactionManager</code>\u914D\u7F6E, \u521B\u5EFA<code>TransactionFactory</code>\u5BF9\u8C61</li><li>\u6570\u636E\u6E90: <code>DataSource</code><code>dataSourceElement</code>\u65B9\u6CD5\u6839\u636E<code>dataSource</code>\u521B\u5EFA\u4E00\u4E2A\u6570\u636E\u6E90\u5DE5\u5382\u5BF9\u8C61, \u5E76\u7531\u8BE5\u5DE5\u5382\u83B7\u53D6\u6570\u636E\u6E90.</li></ul></li></ol><h3 id="databaseidprovider\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#databaseidprovider\u8282\u70B9" aria-hidden="true">#</a> databaseIdProvider\u8282\u70B9</h3><p>mybatis\u6839\u636E\u8BE5\u8282\u70B9\u8BC6\u522B\u6570\u636E\u5382\u5546, \u6267\u884Csql\u8BED\u53E5.<br> MyBatis \u4F1A\u52A0\u8F7D\u5E26\u6709\u5339\u914D\u5F53\u524D\u6570\u636E\u5E93 databaseId \u5C5E\u6027\u548C\u6240\u6709\u4E0D\u5E26 databaseId \u5C5E\u6027\u7684\u8BED\u53E5\u3002 \u5982\u679C\u540C\u65F6\u627E\u5230\u5E26\u6709 databaseId \u548C\u4E0D\u5E26 databaseId \u7684\u76F8\u540C\u8BED\u53E5\uFF0C\u5219\u540E\u8005\u4F1A\u88AB\u820D\u5F03\u3002</p><p>\u53C2\u8003\u914D\u7F6E\u5982\u4E0B:</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>databaseIdProvider</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DB_VENDOR<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>SQL Server<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sqlserver<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DB2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>db2<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Oracle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>oracle<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>databaseIdProvider</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>databaseIdProviderElement</code>\u65B9\u6CD5\u4F1A\u89E3\u6790\u8BE5\u8282\u70B9\u4E3A<code>Configuration</code>\u5BF9\u8C61\u8BBE\u7F6E<code>databaseId</code>.</p><p><code>VendorDatabaseIdProvider</code>\u662F<code>DB_VENDOR</code>\u5BF9\u5E94\u7684mybatis\u6570\u636E\u5E93\u5382\u5546\u8BC6\u522B\u7C7B. \u5B83\u901A\u8FC7\u6570\u636E\u6E90\u7684<code>DatabaseMetaData</code>\u5BF9\u8C61\u7684<code>getDatabaseProductName</code>\u65B9\u6CD5\u83B7\u53D6\u6570\u636E\u5E93\u540D\u79F0, \u4E0E\u5C5E\u6027\u4E2D\u914D\u7F6E\u7684\u952E\u8FDB\u884C\u5339\u914D, \u5982\u679C\u5305\u542B\u5219\u522B\u540D\u8BBE\u7F6E\u4E3A\u8BE5\u952E\u7684\u503C. \u5982\u679C <code>getDatabaseProductName()</code> \u8FD4\u56DE\u201COracle (DataDirect)\u201D\uFF0CdatabaseId \u5C06\u88AB\u8BBE\u7F6E\u4E3A\u201Coracle\u201D\u3002</p><h3 id="typehandlers\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#typehandlers\u8282\u70B9" aria-hidden="true">#</a> typeHandlers\u8282\u70B9</h3><p>mybatis\u7684\u7C7B\u578B\u8F6C\u6362\u5668\u7528\u4E8E\u5904\u7406JDBC\u7C7B\u578B\u548Cjava\u7C7B\u578B\u4E4B\u95F4\u7684\u8F6C\u6362\u903B\u8F91.</p>`,64),r={href:"https://mybatis.org/mybatis-3/zh/configuration.html#typeHandlers",target:"_blank",rel:"noopener noreferrer"},k=s(`<p><code>typeHandlerElement</code>\u5728\u5904\u7406\u8BE5\u8282\u70B9\u65F6, \u5206\u4E3A\u4E24\u79CD\u60C5\u51B5:</p><ol><li>\u4F7F\u7528<code>package</code>\u65B9\u5F0F\u914D\u7F6E.<br> \u8FD9\u79CD\u65B9\u5F0F\u4F1A\u52A0\u8F7D\u6307\u5B9A\u5305\u4E0B\u7684\u6240\u6709\u5B9E\u73B0<code>TypeHandler</code>\u63A5\u53E3\u7684\u5B50\u7C7B(\u63A8\u8350\u91CD\u5199<code>BaseTypeHandler</code>).<br> \u5E76\u83B7\u53D6\u8BE5\u7C7B\u4E0A<code>@MappedJdbcTypes</code>\u6CE8\u89E3\u6240\u6307\u5B9A\u7684<code>JdbcType</code>.<br> \u6700\u540E\u901A\u8FC7<code>typeHandlerRegistry.register</code>\u5B8C\u6210\u6CE8\u518C.</li><li>\u4F7F\u7528<code>typeHandler</code>\u65B9\u5F0F\u914D\u7F6E \u8FD9\u79CD\u65B9\u5F0F\u4F1A\u76F4\u63A5\u83B7\u53D6<code>javaType</code>, <code>jdbcType</code>, <code>handler</code>\u5C5E\u6027, \u901A\u8FC7\u53CD\u5C04\u83B7\u53D6\u5176\u5BF9\u5E94\u7684java\u7C7B\u578B.<br> \u6700\u540E\u901A\u8FC7<code>typeHandlerRegistry.register</code>\u5B8C\u6210\u6CE8\u518C.</li></ol><p>\u6240\u6709\u7684<code>TypeHandler</code>\u90FD\u653E\u5230<code>Map&lt;Class&lt;?&gt;, TypeHandler&lt;?&gt;&gt; allTypeHandlersMap = new HashMap&lt;&gt;();</code>\u4E2D, java\u7C7B\u578B\u548Cjdbc\u7C7B\u578B\u7684\u6620\u5C04\u5173\u7CFB, \u7531<code>Map&lt;Type, Map&lt;JdbcType, TypeHandler&lt;?&gt;&gt;&gt; typeHandlerMap = new ConcurrentHashMap&lt;&gt;();</code>\u7BA1\u7406.<br><code>TypeHandlerRegistry</code>\u521D\u59CB\u5316\u65F6, \u4F1A\u6DFB\u52A0\u9ED8\u8BA4\u7684\u7C7B\u578B\u8F6C\u6362\u5668.</p><h3 id="mappers\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#mappers\u8282\u70B9" aria-hidden="true">#</a> mappers\u8282\u70B9</h3><p>\u8BE5\u8282\u70B9\u652F\u6301\u4F7F\u7528<code>package</code>\u4F5C\u4E3A\u5B50\u8282\u70B9\u914D\u7F6E, \u4E5F\u652F\u6301\u4F7F\u7528\u5B50\u8282\u70B9\u4F7F\u7528<code>resource</code>, <code>url</code>, <code>class</code>\u5C5E\u6027\u914D\u7F6E\u8D44\u6E90\u4F4D\u7F6E.</p><h4 id="_1-\u4F7F\u7528package\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_1-\u4F7F\u7528package\u914D\u7F6E" aria-hidden="true">#</a> 1. \u4F7F\u7528package\u914D\u7F6E</h4><p>\u914D\u7F6E\u5982\u4E0B:</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.mybatis.builder<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7A0B\u5E8F\u4F1A\u83B7\u53D6\u5F53\u524D\u5305\u8DEF\u5F84\u4E0B\u7684\u6240\u6709Class, \u5E76\u4F9D\u6B21\u8C03\u7528<code>addMapper(Class&lt;T&gt; type)</code>\u65B9\u6CD5.</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">addMapper</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">isInterface</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hasMapper</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BindingException</span><span class="token punctuation">(</span><span class="token string">&quot;Type &quot;</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">&quot; is already known to the MapperRegistry.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">boolean</span> loadCompleted <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      knownMappers<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">MapperProxyFactory</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// It&#39;s important that the type is added before the parser is run</span>
      <span class="token comment">// otherwise the binding may automatically be attempted by the</span>
      <span class="token comment">// mapper parser. If the type is already known, it won&#39;t try.</span>
      <span class="token class-name">MapperAnnotationBuilder</span> parser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MapperAnnotationBuilder</span><span class="token punctuation">(</span>config<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
      parser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      loadCompleted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>loadCompleted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        knownMappers<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>addMapper</code>\u53EA\u5BF9\u63A5\u53E3\u7C7B\u578B\u8FDB\u884C\u5904\u7406. \u6240\u6709\u5904\u7406\u8FC7\u7684mapper\u63A5\u53E3\u90FD\u7531<code>Map&lt;Class&lt;?&gt;, MapperProxyFactory&lt;?&gt;&gt; knownMappers = new HashMap&lt;&gt;();</code>\u7BA1\u7406.</p><p><code>hasMapper</code>\u7528\u4E8E\u5224\u65AD\u5F53\u524D\u63A5\u53E3\u662F\u5426\u5B58\u5728\u4E8E<code>knownMappers</code>, \u5B58\u5728\u5219\u4E0D\u7528\u5904\u7406. \u4E0D\u5B58\u5728\u5219\u5411<code>knownMappers</code>\u65B0\u589E\u5F53\u524D\u7C7B\u53CA\u5BF9\u5E94\u7684<code>MapperProxyFactory</code>(\u7528\u4E8E\u52A8\u6001\u4EE3\u7406\u751F\u6210\u5B9E\u4F53, \u6267\u884C\u63A5\u53E3\u65B9\u6CD5).</p><p>\u4E4B\u540E, \u521B\u5EFA<code>MapperAnnotationBuilder</code>\u5BF9\u8C61\u7528\u4E8E\u89E3\u6790\u5F53\u524Dmapper\u63A5\u53E3, <code>parse()</code>\u65B9\u6CD5\u4E3A\u5177\u4F53\u7684\u89E3\u6790\u903B\u8F91.</p><h4 id="_2-\u4F7F\u7528resource\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_2-\u4F7F\u7528resource\u914D\u7F6E" aria-hidden="true">#</a> 2. \u4F7F\u7528resource\u914D\u7F6E</h4><p>\u914D\u7F6E\u5982\u4E0B:</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- \u4F7F\u7528\u76F8\u5BF9\u4E8E\u7C7B\u8DEF\u5F84\u7684\u8D44\u6E90\u5F15\u7528 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org/mybatis/builder/AuthorMapper.xml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org/mybatis/builder/BlogMapper.xml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org/mybatis/builder/PostMapper.xml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>XMLMapperBuilder</code>\u662F\u89E3\u6790sql xml\u6587\u4EF6\u7684\u89E3\u6790\u5668. \u8C03\u7528<code>parse</code>\u65B9\u6CD5\u7528\u4E8E\u89E3\u6790xml.</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">XMLMapperBuilder</span> mapperParser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLMapperBuilder</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">,</span> configuration<span class="token punctuation">,</span> resource<span class="token punctuation">,</span> configuration<span class="token punctuation">.</span><span class="token function">getSqlFragments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mapperParser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-\u4F7F\u7528url\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_3-\u4F7F\u7528url\u914D\u7F6E" aria-hidden="true">#</a> 3. \u4F7F\u7528url\u914D\u7F6E</h4><p>\u89E3\u6790\u65B9\u5F0F\u540C<code>resource</code>\u3002</p><h4 id="_4-\u4F7F\u7528class\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_4-\u4F7F\u7528class\u914D\u7F6E" aria-hidden="true">#</a> 4. \u4F7F\u7528class\u914D\u7F6E</h4><p>\u89E3\u6790\u65B9\u5F0F\u76F8\u5F53\u4E8E<code>package</code>\u4E2D\u904D\u5386\u89E3\u6790Class\u7684\u4E00\u4E2A\u73AF\u8282.</p><h3 id="\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a> \u603B\u7ED3</h3><p>\u51E0\u79CD\u89E3\u6790\u5668:</p><ol><li><code>XMLConfigBuilder</code>: mapper\u914D\u7F6E\u6587\u4EF6xml\u7684\u89E3\u6790. \u5B83\u7684<code>parse</code>\u65B9\u6CD5\u8FD4\u56DE<code>Configuration</code>\u5BF9\u8C61.</li><li><code>XMLMapperBuilder</code>: xml\u6620\u5C04\u6587\u4EF6\u7684\u89E3\u6790.</li><li><code>MapperAnnotationBuilder</code>: \u63A5\u53E3\u6620\u5C04\u7684\u89E3\u6790. \u901A\u8FC7<code>Configuration</code>\u7684<code>addMapper</code> or <code>addMapper</code>\u8C03\u7528\u5230.</li></ol>`,25);function d(v,m){const t=l("ExternalLinkIcon");return e(),o("div",null,[i,n("p",null,[a("\u53C2\u8003: "),n("a",r,[a("mybatis\u7C7B\u578B\u8F6C\u6362\u5668"),c(t)])]),k])}const q=p(u,[["render",d],["__file","\u914D\u7F6E\u6587\u4EF6\u89E3\u6790.html.vue"]]);export{q as default};
